<% header_area = capture do %>
  <%= render "header", locals: { page: page } %>
<% end %>

<% product_area = capture do %>
  <div class="product">
    <%= page.products %>
  </div>
<% end %>

<% content_area = capture do %>
  <% if page.layout.image_style == "cover" %>

    <% if page.top_image %>
      <div class="cover-image" style="background-image: url(<%= page.top_image %>)"></div>
    <% end %>

    <div class="content">
      <%= header_area %>
      <div class="body"><%= page.content %></div>
    </div>

  <% elsif page.layout.image_style == "fit" %>

    <div class="content">
      <img class="top-image" src="<%= page.top_image %>" >
      <%= header_area %>
      <div class="body"><%= page.content %></div>
    </div>

  <% end %>
<% end %>

<article class="split page <%= page.layout.content_overflow %>">
  <% if page.layout.product_align == "left" %>
    <div class="col half"><%= product_area %></div>
    <div class="col half"><%= content_area %></div>
  <% else %>
    <div class="col half"><%= content_area %></div>
    <div class="col half"><%= product_area %></div>
  <% end %>
</article>
