<div id="ddd_trending">
<% sample_products.each_with_index do |product, index| %>
  <% if (index + 1) % 4 == 0 %>

  <% elsif false %>
  <div class="row">
  <% dimension = size(product.image_width, product.image_height) %>
  <%= render 'product', locals: { product: product, dimension: dimension, type: ["split", "normal"].sample} %>
  </div>
  
  <% end %>
<% end %>
</div>

<script>
function getElement(id) {
  return document.getElementById(id);
}

function slideTo(id) {
  //1.) the page we are bringing into focus dictates how
  // the current page will exit. So let's see what classes
  // our incoming page is using. We know it will have stage[right|left|etc...]
  var classes = getElement(id).className.split(' ');

  //2.) decide if the incoming page is assigned to right or left
  // (-1 if no match)
  var stageType = classes.indexOf('stage-left');

  //3.) on initial page load focusPage is null, so we need
  // to set the default page which we're currently seeing.
  if (FOCUS_PAGE == null) {
    // use home page
    FOCUS_PAGE = getElement('home-page');
  }

  //4.) decide how this focused page should exit.
  if (stageType > 0) {
    FOCUS_PAGE.className = 'page transition stage-right';
  } else {
    FOCUS_PAGE.className = 'page transition stage-left';
  }

  //5. refresh/set the global variable
  FOCUS_PAGE = getElement(id);

  //6. Bring in the new page.
  FOCUS_PAGE.className = 'page transition stage-center';
}
</script>
<style>

/*.pages {
  -webkit-transform: translate3d(0,0,0);
  -moz-transform: translate3d(0,0,0);
  -ms-transform: translate3d(0,0,0);
  -o-transform: translate3d(0,0,0);
  transform: translate3d(0,0,0);
}
*/
 .scrollable {
    display: inline-block;
    max-width: 1000px;
    
    left: 0;
    white-space: nowrap;
}
/*  .page {
    display: none;
    background: rgba(255,0,0,0.4);
    display: inline-block;
    width: 100%;
    height: 100%;
    -webkit-transform: translate3d(0, 0, 0);
    transition: margin 0.25s ease-in-out;
  }*/
  .page {

      display: inline-block;
      width: 100%;
      height: 100%;
      margin-right: 20px;
      color: #fff;
      font: 40px Helvetica;
      padding: 10px;
      -webkit-box-sizing: border-box;
      white-space: normal;
      background-color: #222;
      background-size: cover;
  }
  
  .page.current {
/*    visibility: visible;
*//*    margin-left: -450px;*/
  }
/*  
  .page.next {
    visibility: visible;
    display: block;
    margin-left: 500px;
  }
  
  .page.far-next {
    display: block;
    margin-left: 1500px;
  }
  
  .page.prev {
    
  }
  */
  .page.far-prev {
    
  }
</style>

<div class="slides scrollable horizontal paginated universal">  
  <div class="page">
    <h1>Page here</h1>
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
  </div>

  <div class="page">
    <h1>Page two</h1>
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
  </div>

  <div class="page">
    <h1>Page 3 </h3>
    
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </p>
  </div>
</div>

<script>

var scrollable = document.querySelector('.scrollable');
scrollable.addEventListener("scrollability-start", function(event) {
    var pageIndex = Math.round(event.position/(viewport+margin));
    var roundOffset = pageIndex * (viewport+margin);

    var offset = -(maxWidth/2 - viewport/2) - roundOffset;
    var clipoff = (((viewport+margin))) + roundOffset;

    gallery.style.left = clipoff + "px";

    event.setSpacing(margin);
    event.setOffset(offset);
});
</script>